import pandas as pd
from shapely import wkt
import geopandas as gpd


# Use wkt to describe a polygon (in Australia albers (3577)) for clipping our NGIS data

bounding_box = "Polygon ((1017760.76728096301667392 -3541957.70058736298233271, 1033044.96912370761856437 -3380500.8970661829225719, 1362219.94902850710786879 -3210531.94267989695072174, 1461582.75826686783693731 -3229754.48591392068192363, 1547489.18534193048253655 -3368580.82105459086596966, 1518569.3516713276039809 -3414031.0364407654851675, 1418155.4332151913549751 -3421778.12315146625041962, 1359002.49710371834225953 -3370541.71342544769868255, 1317053.06696818908676505 -3416099.50407753139734268, 1073812.87129989336244762 -3543764.89405762869864702, 1017760.76728096301667392 -3541957.70058736298233271))"

p1 = wkt.loads(bounding_box)

infile = r"E:\GA\UDF\data\boreholes\SURVEY_Holes_with_strat_or_lith.shp"

gdf = gpd.read_file(infile).to_crs("epsg:3577")

gdf_DCD = gdf[gdf.geometry.within(p1)]

outfile = r"E:\GA\UDF\compilation\staging\DCD_bores.csv"
gdf_DCD.to_csv(outfile)